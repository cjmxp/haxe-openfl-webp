#!/bin/bash
FILES=
FILES="$FILES project/webp/dec/alpha.c"
FILES="$FILES project/webp/dec/buffer.c"
FILES="$FILES project/webp/dec/frame.c"
FILES="$FILES project/webp/dec/idec.c"
FILES="$FILES project/webp/dec/io.c"
FILES="$FILES project/webp/dec/layer.c"
FILES="$FILES project/webp/dec/quant.c"
FILES="$FILES project/webp/dec/tree.c"
FILES="$FILES project/webp/dec/vp8.c"
FILES="$FILES project/webp/dec/vp8l.c"
FILES="$FILES project/webp/dec/webp.c"
FILES="$FILES project/webp/dsp/cpu.c"
FILES="$FILES project/webp/dsp/dec.c"
FILES="$FILES project/webp/dsp/enc.c"
FILES="$FILES project/webp/dsp/lossless.c"
FILES="$FILES project/webp/dsp/upsampling.c"
FILES="$FILES project/webp/dsp/yuv.c"
FILES="$FILES project/webp/enc/alpha.c"
FILES="$FILES project/webp/enc/analysis.c"
FILES="$FILES project/webp/enc/backward_references.c"
FILES="$FILES project/webp/enc/config.c"
FILES="$FILES project/webp/enc/cost.c"
FILES="$FILES project/webp/enc/filter.c"
FILES="$FILES project/webp/enc/frame.c"
FILES="$FILES project/webp/enc/histogram.c"
FILES="$FILES project/webp/enc/iterator.c"
FILES="$FILES project/webp/enc/layer.c"
FILES="$FILES project/webp/enc/picture.c"
FILES="$FILES project/webp/enc/quant.c"
FILES="$FILES project/webp/enc/syntax.c"
FILES="$FILES project/webp/enc/tree.c"
FILES="$FILES project/webp/enc/vp8l.c"
FILES="$FILES project/webp/enc/webpenc.c"
FILES="$FILES project/webp/mux/demux.c"
FILES="$FILES project/webp/mux/muxedit.c"
FILES="$FILES project/webp/mux/muxinternal.c"
FILES="$FILES project/webp/mux/muxread.c"
FILES="$FILES project/webp/utils/bit_reader.c"
FILES="$FILES project/webp/utils/bit_writer.c"
FILES="$FILES project/webp/utils/color_cache.c"
FILES="$FILES project/webp/utils/filters.c"
FILES="$FILES project/webp/utils/huffman.c"
FILES="$FILES project/webp/utils/huffman_encode.c"
FILES="$FILES project/webp/utils/quant_levels.c"
FILES="$FILES project/webp/utils/rescaler.c"
FILES="$FILES project/webp/utils/thread.c"
FILES="$FILES project/webp/utils/utils.c"

#PARAMS=
#PARAMS="$PARAMS -O0"
#PARAMS="$PARAMS -O1"
#PARAMS="$PARAMS -O2"

#PARAMS=" -O3 -s EXPORTED_FUNCTIONS='["_WebPDecodeRGBA"]'"
#PARAMS=" -O1 -s EXPORTED_FUNCTIONS='["_WebPDecodeRGBA"]' --minify 1"
PARAMS=" -O0 -s EXPORTED_FUNCTIONS='["_WebPDecodeRGBA"]' --minify 0"

INCLUDE=
INCLUDE="$INCLUDE -I. -Iproject -Iproject/webp -Iproject/webp/utils -Iproject/webp/enc -Iproject/webp/dec -Iproject/webp/webp"

pushd ../..
emcc $PARAMS $INCLUDE $FILES -o tests/emscripten/js/libwebp.js
popd